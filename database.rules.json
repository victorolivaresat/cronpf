{
  "rules": {
    "users": {
      // Any authenticated user can read the users list to find members
      ".read": "auth != null",
      "$uid": {
        // But a user can only write to their own profile
        ".write": "$uid === auth.uid"
      }
    },
    "projects": {
      "$projectId": {
        // A user can read a project if they are a member
        ".read": "data.child('members').hasChild(auth.uid)",
        // A user can write to a project if they are a member
        ".write": "data.child('members').hasChild(auth.uid)",
        // Validation for creating new projects
        ".validate": "newData.hasChildren(['title', 'ownerId', 'members']) && newData.child('ownerId').val() === auth.uid"
      }
    }
  }
}
